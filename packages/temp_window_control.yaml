temp_window_control:
  # ===================================================================
  # TEMPERATURE WINDOW CONTROL AUTOMATION
  # ===================================================================
  # –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è —Ñ–æ—Ä—Ç–æ—á–µ–∫ –ø—Ä–∏ –Ω–∏–∑–∫–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ
  #
  # –õ–æ–≥–∏–∫–∞:
  # - –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ < 21¬∞C ‚Üí –ø—Ä–æ–≤–µ—Ä—è–µ–º –æ–∫–Ω–æ
  # - –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–æ ‚Üí –∑–∞–∫—Ä—ã–≤–∞–µ–º
  # - –ï—Å–ª–∏ —É–∂–µ –∑–∞–∫—Ä—ã—Ç–æ ‚Üí —É–≤–µ–¥–æ–º–ª—è–µ–º –≤ Telegram
  # - –ü–æ–≤—Ç–æ—Ä –Ω–µ —á–∞—â–µ 1 —Ä–∞–∑–∞ –≤ —á–∞—Å –¥–ª—è –∫–∞–∂–¥–æ–π –∫–æ–º–Ω–∞—Ç—ã
  #
  # –£—Å—Ç–∞–Ω–æ–≤–∫–∞:
  # 1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª: config/packages/temp_window_control.yaml
  # 2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Home Assistant
  # ===================================================================

  # -------------------------------------------------------------------
  # Input DateTime (–¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è)
  # -------------------------------------------------------------------
  input_datetime:
    temp_window_last_action_andrey:
      name: "–ê–Ω–¥—Ä–µ–π: –ü–æ—Å–ª–µ–¥–Ω–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ —Å —Ñ–æ—Ä—Ç–æ—á–∫–æ–π"
      has_date: true
      has_time: true
      icon: mdi:clock-outline

    temp_window_last_action_agata:
      name: "–ê–≥–∞—Ç–∞: –ü–æ—Å–ª–µ–¥–Ω–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ —Å —Ñ–æ—Ä—Ç–æ—á–∫–æ–π"
      has_date: true
      has_time: true
      icon: mdi:clock-outline

    temp_window_last_action_artem:
      name: "–ê—Ä—Ç—ë–º: –ü–æ—Å–ª–µ–¥–Ω–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ —Å —Ñ–æ—Ä—Ç–æ—á–∫–æ–π"
      has_date: true
      has_time: true
      icon: mdi:clock-outline

    temp_window_last_action_bedroom:
      name: "–°–ø–∞–ª—å–Ω—è: –ü–æ—Å–ª–µ–¥–Ω–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ —Å —Ñ–æ—Ä—Ç–æ—á–∫–æ–π"
      has_date: true
      has_time: true
      icon: mdi:clock-outline

  # -------------------------------------------------------------------
  # Automation (–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –∫–æ–º–Ω–∞—Ç—ã)
  # -------------------------------------------------------------------
  automation:
    # 1. –ö–û–ú–ù–ê–¢–ê –ê–ù–î–†–ï–Ø
    # -----------------------------------------------------------------
    - id: "temp_window_control_andrey"
      alias: "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: –§–æ—Ä—Ç–æ—á–∫–∞ –ê–Ω–¥—Ä–µ—è"
      description: "–ó–∞–∫—Ä—ã–≤–∞–µ—Ç —Ñ–æ—Ä—Ç–æ—á–∫—É –ê–Ω–¥—Ä–µ—è –ø—Ä–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ –Ω–∏–∂–µ 21¬∞C"

      trigger:
        - platform: numeric_state
          entity_id: sensor.0x00124b00272a6db8_temperature_2
          below: 21
          for:
            minutes: 2 # –ó–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π

      condition:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø—Ä–æ—à—ë–ª —á–∞—Å —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è
        - condition: template
          value_template: >
            {% set last_action = states('input_datetime.temp_window_last_action_andrey') %}
            {% if last_action in ['unknown', 'unavailable', ''] %}
              true
            {% else %}
              {{ (as_timestamp(now()) - as_timestamp(last_action)) >= 3600 }}
            {% endif %}

        # –î–∞—Ç—á–∏–∫ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –¥–æ—Å—Ç—É–ø–µ–Ω
        - condition: template
          value_template: "{{ states('sensor.0x00124b00272a6db8_temperature_2') not in ['unavailable', 'unknown'] }}"

        # –ü—Ä–∏–≤–æ–¥ –¥–æ—Å—Ç—É–ø–µ–Ω
        - condition: template
          value_template: "{{ states('cover.drivent_d16') not in ['unavailable', 'unknown'] }}"

      action:
        - variables:
            current_temp: "{{ states('sensor.0x00124b00272a6db8_temperature_2') | float }}"
            window_state: "{{ states('cover.drivent_d16') }}"

        - choose:
            # –ï—Å–ª–∏ —Ñ–æ—Ä—Ç–æ—á–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∞ - –∑–∞–∫—Ä—ã–≤–∞–µ–º
            - conditions:
                - condition: template
                  value_template: "{{ window_state in ['open', 'opening'] }}"
              sequence:
                - service: cover.close_cover
                  target:
                    entity_id: cover.drivent_d16

                - service: telegram_bot.send_message
                  data:
                    config_entry_id: !secret telegram_entry_id_info
                    message: |
                      üå°Ô∏è –§–æ—Ä—Ç–æ—á–∫–∞ –ê–Ω–¥—Ä–µ—è –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è

                      ‚ùÑÔ∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: {{ current_temp }}¬∞C (–Ω–∏–∂–µ 21¬∞C)
                      ü™ü –°—Ç–∞—Ç—É—Å: –±—ã–ª–∞ –æ—Ç–∫—Ä—ã—Ç–∞ ‚Üí –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è
                      ‚è∞ –í—Ä–µ–º—è: {{ now().strftime('%H:%M:%S') }}
                    target:
                      - !secret chat_info

                - service: logbook.log
                  data:
                    name: "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞"
                    message: "‚ùÑÔ∏è –ê–Ω–¥—Ä–µ–π: —Ñ–æ—Ä—Ç–æ—á–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞ –∏–∑-–∑–∞ –Ω–∏–∑–∫–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã ({{ current_temp }}¬∞C)"

          # –ï—Å–ª–∏ —Ñ–æ—Ä—Ç–æ—á–∫–∞ —É–∂–µ –∑–∞–∫—Ä—ã—Ç–∞ - —É–≤–µ–¥–æ–º–ª—è–µ–º
          default:
            - service: telegram_bot.send_message
              data:
                config_entry_id: !secret telegram_entry_id_info
                message: |
                  ‚ö†Ô∏è –§–æ—Ä—Ç–æ—á–∫–∞ –ê–Ω–¥—Ä–µ—è –∑–∞–∫—Ä—ã—Ç–∞, –Ω–æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Å–Ω–∏–∑–∏–ª–∞—Å—å

                  ‚ùÑÔ∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: {{ current_temp }}¬∞C (–Ω–∏–∂–µ 21¬∞C)
                  ü™ü –°—Ç–∞—Ç—É—Å: —É–∂–µ –∑–∞–∫—Ä—ã—Ç–∞
                  ‚è∞ –í—Ä–µ–º—è: {{ now().strftime('%H:%M:%S') }}

                  üí° –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–æ–ø–ª–µ–Ω–∏–µ –≤ –∫–æ–º–Ω–∞—Ç–µ!
                target:
                  - !secret chat_info

            - service: logbook.log
              data:
                name: "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞"
                message: "‚ö†Ô∏è –ê–Ω–¥—Ä–µ–π: —Ñ–æ—Ä—Ç–æ—á–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞, –Ω–æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–∏–∑–∫–∞—è ({{ current_temp }}¬∞C)"

        # –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è
        - service: input_datetime.set_datetime
          target:
            entity_id: input_datetime.temp_window_last_action_andrey
          data:
            datetime: "{{ now().strftime('%Y-%m-%d %H:%M:%S') }}"

    # 2. –ö–û–ú–ù–ê–¢–ê –ê–ì–ê–¢–´
    # -----------------------------------------------------------------
    - id: "temp_window_control_agata"
      alias: "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: –§–æ—Ä—Ç–æ—á–∫–∞ –ê–≥–∞—Ç—ã"
      description: "–ó–∞–∫—Ä—ã–≤–∞–µ—Ç —Ñ–æ—Ä—Ç–æ—á–∫—É –ê–≥–∞—Ç—ã –ø—Ä–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ –Ω–∏–∂–µ 21¬∞C"

      trigger:
        - platform: numeric_state
          entity_id: sensor.0x00124b00272b9087_temperature
          below: 21
          for:
            minutes: 2

      condition:
        - condition: template
          value_template: >
            {% set last_action = states('input_datetime.temp_window_last_action_agata') %}
            {% if last_action in ['unknown', 'unavailable', ''] %}
              true
            {% else %}
              {{ (as_timestamp(now()) - as_timestamp(last_action)) >= 3600 }}
            {% endif %}

        - condition: template
          value_template: "{{ states('sensor.0x00124b00272b9087_temperature') not in ['unavailable', 'unknown'] }}"

        - condition: template
          value_template: "{{ states('cover.drivent_6b4') not in ['unavailable', 'unknown'] }}"

      action:
        - variables:
            current_temp: "{{ states('sensor.0x00124b00272b9087_temperature') | float }}"
            window_state: "{{ states('cover.drivent_6b4') }}"

        - choose:
            - conditions:
                - condition: template
                  value_template: "{{ window_state in ['open', 'opening'] }}"
              sequence:
                - service: cover.close_cover
                  target:
                    entity_id: cover.drivent_6b4

                - service: telegram_bot.send_message
                  data:
                    config_entry_id: !secret telegram_entry_id_info
                    message: |
                      üå°Ô∏è –§–æ—Ä—Ç–æ—á–∫–∞ –ê–≥–∞—Ç—ã –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è

                      ‚ùÑÔ∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: {{ current_temp }}¬∞C (–Ω–∏–∂–µ 21¬∞C)
                      ü™ü –°—Ç–∞—Ç—É—Å: –±—ã–ª–∞ –æ—Ç–∫—Ä—ã—Ç–∞ ‚Üí –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è
                      ‚è∞ –í—Ä–µ–º—è: {{ now().strftime('%H:%M:%S') }}
                    target:
                      - !secret chat_info

                - service: logbook.log
                  data:
                    name: "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞"
                    message: "‚ùÑÔ∏è –ê–≥–∞—Ç–∞: —Ñ–æ—Ä—Ç–æ—á–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞ –∏–∑-–∑–∞ –Ω–∏–∑–∫–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã ({{ current_temp }}¬∞C)"

          default:
            - service: telegram_bot.send_message
              data:
                config_entry_id: !secret telegram_entry_id_info
                message: |
                  ‚ö†Ô∏è –§–æ—Ä—Ç–æ—á–∫–∞ –ê–≥–∞—Ç—ã –∑–∞–∫—Ä—ã—Ç–∞, –Ω–æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Å–Ω–∏–∑–∏–ª–∞—Å—å

                  ‚ùÑÔ∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: {{ current_temp }}¬∞C (–Ω–∏–∂–µ 21¬∞C)
                  ü™ü –°—Ç–∞—Ç—É—Å: —É–∂–µ –∑–∞–∫—Ä—ã—Ç–∞
                  ‚è∞ –í—Ä–µ–º—è: {{ now().strftime('%H:%M:%S') }}

                  üí° –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–æ–ø–ª–µ–Ω–∏–µ –≤ –∫–æ–º–Ω–∞—Ç–µ!
                target:
                  - !secret chat_info

            - service: logbook.log
              data:
                name: "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞"
                message: "‚ö†Ô∏è –ê–≥–∞—Ç–∞: —Ñ–æ—Ä—Ç–æ—á–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞, –Ω–æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–∏–∑–∫–∞—è ({{ current_temp }}¬∞C)"

        - service: input_datetime.set_datetime
          target:
            entity_id: input_datetime.temp_window_last_action_agata
          data:
            datetime: "{{ now().strftime('%Y-%m-%d %H:%M:%S') }}"

    # 3. –ö–û–ú–ù–ê–¢–ê –ê–†–¢–Å–ú–ê
    # -----------------------------------------------------------------
    - id: "temp_window_control_artem"
      alias: "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: –§–æ—Ä—Ç–æ—á–∫–∞ –ê—Ä—Ç—ë–º–∞"
      description: "–ó–∞–∫—Ä—ã–≤–∞–µ—Ç —Ñ–æ—Ä—Ç–æ—á–∫—É –ê—Ä—Ç—ë–º–∞ –ø—Ä–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ –Ω–∏–∂–µ 21¬∞C"

      trigger:
        - platform: numeric_state
          entity_id: sensor.0x00124b002725c63f_temperature
          below: 21
          for:
            minutes: 2

      condition:
        - condition: template
          value_template: >
            {% set last_action = states('input_datetime.temp_window_last_action_artem') %}
            {% if last_action in ['unknown', 'unavailable', ''] %}
              true
            {% else %}
              {{ (as_timestamp(now()) - as_timestamp(last_action)) >= 3600 }}
            {% endif %}

        - condition: template
          value_template: "{{ states('sensor.0x00124b002725c63f_temperature') not in ['unavailable', 'unknown'] }}"

        - condition: template
          value_template: "{{ states('cover.drivent_b62') not in ['unavailable', 'unknown'] }}"

      action:
        - variables:
            current_temp: "{{ states('sensor.0x00124b002725c63f_temperature') | float }}"
            window_state: "{{ states('cover.drivent_b62') }}"

        - choose:
            - conditions:
                - condition: template
                  value_template: "{{ window_state in ['open', 'opening'] }}"
              sequence:
                - service: cover.close_cover
                  target:
                    entity_id: cover.drivent_b62

                - service: telegram_bot.send_message
                  data:
                    config_entry_id: !secret telegram_entry_id_info
                    message: |
                      üå°Ô∏è –§–æ—Ä—Ç–æ—á–∫–∞ –ê—Ä—Ç—ë–º–∞ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è

                      ‚ùÑÔ∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: {{ current_temp }}¬∞C (–Ω–∏–∂–µ 21¬∞C)
                      ü™ü –°—Ç–∞—Ç—É—Å: –±—ã–ª–∞ –æ—Ç–∫—Ä—ã—Ç–∞ ‚Üí –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è
                      ‚è∞ –í—Ä–µ–º—è: {{ now().strftime('%H:%M:%S') }}
                    target:
                      - !secret chat_info

                - service: logbook.log
                  data:
                    name: "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞"
                    message: "‚ùÑÔ∏è –ê—Ä—Ç—ë–º: —Ñ–æ—Ä—Ç–æ—á–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞ –∏–∑-–∑–∞ –Ω–∏–∑–∫–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã ({{ current_temp }}¬∞C)"

          default:
            - service: telegram_bot.send_message
              data:
                config_entry_id: !secret telegram_entry_id_info
                message: |
                  ‚ö†Ô∏è –§–æ—Ä—Ç–æ—á–∫–∞ –ê—Ä—Ç—ë–º–∞ –∑–∞–∫—Ä—ã—Ç–∞, –Ω–æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Å–Ω–∏–∑–∏–ª–∞—Å—å

                  ‚ùÑÔ∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: {{ current_temp }}¬∞C (–Ω–∏–∂–µ 21¬∞C)
                  ü™ü –°—Ç–∞—Ç—É—Å: —É–∂–µ –∑–∞–∫—Ä—ã—Ç–∞
                  ‚è∞ –í—Ä–µ–º—è: {{ now().strftime('%H:%M:%S') }}

                  üí° –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–æ–ø–ª–µ–Ω–∏–µ –≤ –∫–æ–º–Ω–∞—Ç–µ!
                target:
                  - !secret chat_info

            - service: logbook.log
              data:
                name: "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞"
                message: "‚ö†Ô∏è –ê—Ä—Ç—ë–º: —Ñ–æ—Ä—Ç–æ—á–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞, –Ω–æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–∏–∑–∫–∞—è ({{ current_temp }}¬∞C)"

        - service: input_datetime.set_datetime
          target:
            entity_id: input_datetime.temp_window_last_action_artem
          data:
            datetime: "{{ now().strftime('%Y-%m-%d %H:%M:%S') }}"

    # 4. –°–ü–ê–õ–¨–ù–Ø
    # -----------------------------------------------------------------
    - id: "temp_window_control_bedroom"
      alias: "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: –§–æ—Ä—Ç–æ—á–∫–∞ —Å–ø–∞–ª—å–Ω–∏"
      description: "–ó–∞–∫—Ä—ã–≤–∞–µ—Ç —Ñ–æ—Ä—Ç–æ—á–∫—É —Å–ø–∞–ª—å–Ω–∏ –ø—Ä–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ –Ω–∏–∂–µ 21¬∞C"

      trigger:
        - platform: numeric_state
          entity_id: sensor.0x00124b0027250176_temperature
          below: 21
          for:
            minutes: 2

      condition:
        - condition: template
          value_template: >
            {% set last_action = states('input_datetime.temp_window_last_action_bedroom') %}
            {% if last_action in ['unknown', 'unavailable', ''] %}
              true
            {% else %}
              {{ (as_timestamp(now()) - as_timestamp(last_action)) >= 3600 }}
            {% endif %}

        - condition: template
          value_template: "{{ states('sensor.0x00124b0027250176_temperature') not in ['unavailable', 'unknown'] }}"

        - condition: template
          value_template: "{{ states('cover.drivent_69f') not in ['unavailable', 'unknown'] }}"

      action:
        - variables:
            current_temp: "{{ states('sensor.0x00124b0027250176_temperature') | float }}"
            window_state: "{{ states('cover.drivent_69f') }}"

        - choose:
            - conditions:
                - condition: template
                  value_template: "{{ window_state in ['open', 'opening'] }}"
              sequence:
                - service: cover.close_cover
                  target:
                    entity_id: cover.drivent_69f

                - service: telegram_bot.send_message
                  data:
                    config_entry_id: !secret telegram_entry_id_info
                    message: |
                      üå°Ô∏è –§–æ—Ä—Ç–æ—á–∫–∞ —Å–ø–∞–ª—å–Ω–∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è

                      ‚ùÑÔ∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: {{ current_temp }}¬∞C (–Ω–∏–∂–µ 21¬∞C)
                      ü™ü –°—Ç–∞—Ç—É—Å: –±—ã–ª–∞ –æ—Ç–∫—Ä—ã—Ç–∞ ‚Üí –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è
                      ‚è∞ –í—Ä–µ–º—è: {{ now().strftime('%H:%M:%S') }}
                    target:
                      - !secret chat_info

                - service: logbook.log
                  data:
                    name: "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞"
                    message: "‚ùÑÔ∏è –°–ø–∞–ª—å–Ω—è: —Ñ–æ—Ä—Ç–æ—á–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞ –∏–∑-–∑–∞ –Ω–∏–∑–∫–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã ({{ current_temp }}¬∞C)"

          default:
            - service: telegram_bot.send_message
              data:
                config_entry_id: !secret telegram_entry_id_info
                message: |
                  ‚ö†Ô∏è –§–æ—Ä—Ç–æ—á–∫–∞ —Å–ø–∞–ª—å–Ω–∏ –∑–∞–∫—Ä—ã—Ç–∞, –Ω–æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Å–Ω–∏–∑–∏–ª–∞—Å—å

                  ‚ùÑÔ∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: {{ current_temp }}¬∞C (–Ω–∏–∂–µ 21¬∞C)
                  ü™ü –°—Ç–∞—Ç—É—Å: —É–∂–µ –∑–∞–∫—Ä—ã—Ç–∞
                  ‚è∞ –í—Ä–µ–º—è: {{ now().strftime('%H:%M:%S') }}

                  üí° –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–æ–ø–ª–µ–Ω–∏–µ –≤ –∫–æ–º–Ω–∞—Ç–µ!
                target:
                  - !secret chat_info

            - service: logbook.log
              data:
                name: "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞"
                message: "‚ö†Ô∏è –°–ø–∞–ª—å–Ω—è: —Ñ–æ—Ä—Ç–æ—á–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞, –Ω–æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–∏–∑–∫–∞—è ({{ current_temp }}¬∞C)"

        - service: input_datetime.set_datetime
          target:
            entity_id: input_datetime.temp_window_last_action_bedroom
          data:
            datetime: "{{ now().strftime('%Y-%m-%d %H:%M:%S') }}"

  # ===================================================================
  # TEMPLATE SENSORS (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞)
  # ===================================================================
  template:
    - sensor:
        # –û–±—â–∏–π —Å—Ç–∞—Ç—É—Å —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è
        - name: "Temperature Window Control Status"
          unique_id: temp_window_control_status
          icon: mdi:thermometer-auto
          state: >
            {% set rooms_cold = 0 %}
            {% if states('sensor.0x00124b00272a6db8_temperature_2') | float < 21 %}
              {% set rooms_cold = rooms_cold + 1 %}
            {% endif %}
            {% if states('sensor.0x00124b00272b9087_temperature') | float < 21 %}
              {% set rooms_cold = rooms_cold + 1 %}
            {% endif %}
            {% if states('sensor.0x00124b002725c63f_temperature') | float < 21 %}
              {% set rooms_cold = rooms_cold + 1 %}
            {% endif %}
            {% if states('sensor.0x00124b0027250176_temperature') | float < 21 %}
              {% set rooms_cold = rooms_cold + 1 %}
            {% endif %}

            {% if rooms_cold == 0 %}
              –í—Å–µ –∫–æ–º–Ω–∞—Ç—ã —Ç—ë–ø–ª—ã–µ
            {% elif rooms_cold == 1 %}
              1 –∫–æ–º–Ω–∞—Ç–∞ —Ö–æ–ª–æ–¥–Ω–∞—è
            {% else %}
              {{ rooms_cold }} –∫–æ–º–Ω–∞—Ç—ã —Ö–æ–ª–æ–¥–Ω—ã–µ
            {% endif %}
          attributes:
            andrey_temp: "{{ states('sensor.0x00124b00272a6db8_temperature_2') }}¬∞C"
            agata_temp: "{{ states('sensor.0x00124b00272b9087_temperature') }}¬∞C"
            artem_temp: "{{ states('sensor.0x00124b002725c63f_temperature') }}¬∞C"
            bedroom_temp: "{{ states('sensor.0x00124b0027250176_temperature') }}¬∞C"
            andrey_window: "{{ states('cover.drivent_d16') }}"
            agata_window: "{{ states('cover.drivent_6b4') }}"
            artem_window: "{{ states('cover.drivent_b62') }}"
            bedroom_window: "{{ states('cover.drivent_69f') }}"

  # ===================================================================
  # DASHBOARD –ö–ê–†–¢–û–ß–ö–ê –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
  # ===================================================================
  # type: vertical-stack
  # cards:
  #   # –û–±—â–∏–π —Å—Ç–∞—Ç—É—Å
  #   - type: entities
  #     title: üå°Ô∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –æ–∫–æ–Ω
  #     entities:
  #       - entity: sensor.temperature_window_control_status
  #         name: –°—Ç–∞—Ç—É—Å
  #     state_color: true
  #
  #   # –î–µ—Ç–∞–ª–∏ –ø–æ –∫–æ–º–Ω–∞—Ç–∞–º
  #   - type: entities
  #     title: üå°Ô∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∏ —Ñ–æ—Ä—Ç–æ—á–∫–∏
  #     entities:
  #       - type: section
  #         label: –ê–Ω–¥—Ä–µ–π
  #       - entity: sensor.0x00124b00272a6db8_temperature_2
  #         name: –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞
  #       - entity: cover.drivent_d16
  #         name: –§–æ—Ä—Ç–æ—á–∫–∞
  #
  #       - type: section
  #         label: –ê–≥–∞—Ç–∞
  #       - entity: sensor.0x00124b00272b9087_temperature
  #         name: –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞
  #       - entity: cover.drivent_6b4
  #         name: –§–æ—Ä—Ç–æ—á–∫–∞
  #
  #       - type: section
  #         label: –ê—Ä—Ç—ë–º
  #       - entity: sensor.0x00124b002725c63f_temperature
  #         name: –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞
  #       - entity: cover.drivent_b62
  #         name: –§–æ—Ä—Ç–æ—á–∫–∞
  #
  #       - type: section
  #         label: –°–ø–∞–ª—å–Ω—è
  #       - entity: sensor.0x00124b0027250176_temperature
  #         name: –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞
  #       - entity: cover.drivent_69f
  #         name: –§–æ—Ä—Ç–æ—á–∫–∞
  #     state_color: true

  # ===================================================================
  # –õ–û–ì–ò–ö–ê –†–ê–ë–û–¢–´
  # ===================================================================
  #
  # –î–õ–Ø –ö–ê–ñ–î–û–ô –ö–û–ú–ù–ê–¢–´:
  #
  # 1. –¢–†–ò–ì–ì–ï–†:
  #    - –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ < 21¬∞C –≤ —Ç–µ—á–µ–Ω–∏–µ 2 –º–∏–Ω—É—Ç
  #
  # 2. –£–°–õ–û–í–ò–Ø:
  #    - –ü—Ä–æ—à—ë–ª —á–∞—Å —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è (–∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞)
  #    - –î–∞—Ç—á–∏–∫ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –¥–æ—Å—Ç—É–ø–µ–Ω
  #    - –ü—Ä–∏–≤–æ–¥ –æ–∫–Ω–∞ –¥–æ—Å—Ç—É–ø–µ–Ω
  #
  # 3. –î–ï–ô–°–¢–í–ò–Ø:
  #    –ê) –ï—Å–ª–∏ —Ñ–æ—Ä—Ç–æ—á–∫–∞ –û–¢–ö–†–´–¢–ê:
  #       - –ó–∞–∫—Ä—ã—Ç—å —Ñ–æ—Ä—Ç–æ—á–∫—É
  #       - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: "–§–æ—Ä—Ç–æ—á–∫–∞ ... –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è"
  #       - –° —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–æ–π –∏ —Å—Ç–∞—Ç—É—Å–æ–º
  #
  #    –ë) –ï—Å–ª–∏ —Ñ–æ—Ä—Ç–æ—á–∫–∞ –£–ñ–ï –ó–ê–ö–†–´–¢–ê:
  #       - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: "–§–æ—Ä—Ç–æ—á–∫–∞ ... –∑–∞–∫—Ä—ã—Ç–∞, –Ω–æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Å–Ω–∏–∑–∏–ª–∞—Å—å"
  #       - –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–æ–ø–ª–µ–Ω–∏–µ
  #
  # 4. –ó–ê–ü–ò–°–¨ –í–†–ï–ú–ï–ù–ò:
  #    - –û–±–Ω–æ–≤–ª—è–µ–º input_datetime –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–æ–≤—Ç–æ—Ä–æ–≤
  #
  # –ó–ê–©–ò–¢–ê –û–¢ –°–ü–ê–ú–ê:
  # - –ó–∞–¥–µ—Ä–∂–∫–∞ 2 –º–∏–Ω—É—Ç—ã –ø–µ—Ä–µ–¥ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ–º
  # - –ü–æ–≤—Ç–æ—Ä –Ω–µ —á–∞—â–µ 1 —Ä–∞–∑–∞ –≤ —á–∞—Å –¥–ª—è –∫–∞–∂–¥–æ–π –∫–æ–º–Ω–∞—Ç—ã
  # - –ù–µ–∑–∞–≤–∏—Å–∏–º–∞—è —Ä–∞–±–æ—Ç–∞ –¥–ª—è –∫–∞–∂–¥–æ–π –∫–æ–º–Ω–∞—Ç—ã
  #
  # ===================================================================
